
##**流量控制**
让发送发送速率不要过快，让接收方来得及接收。利用滑动窗口机制就可以实施流量控制。

###原理
 这就是运用 TCP 报文段中的窗口大小字段来控制，发送方的发送窗口不可以大于接收方发回的窗口大小




###TCP的滑动窗口主要有两个作用
- 一是提供TCP的可靠性
- 二是提供TCP的流控特性


##滑动窗口基本原理


1. 对于TCP会话的发送方，任何时候在其发送缓存内的数据都可以分为4类，“已经发送并得到对端ACK的”，“已经发送但还未收到对端ACK的”，“未发送但对端允许发送的”，“未发送且对端不允许发送”。** “已经发送但还未收到对端ACK的”和“未发送但对端允许发送的”这两部分数据称之为发送窗口（中间两部分）。**
![](http://i.imgur.com/dnu3sqH.png)


    当收到接收方新的ACK对于发送窗口中后续字节的确认是，窗口滑动，滑动原理如下图。
![](http://i.imgur.com/m7llZkg.png)




    当收到ACK=36时窗口滑动。

2. 对于TCP的接收方，在某一时刻在它的接收缓存内存在3种。 **“已接收”，“未接收准备接收”，“未接收并未准备接收”（由于ACK直接由TCP协议栈回复，默认无应用延迟，不存在“已接收未回复ACK”）。 其中“未接收准备接收”称之为接收窗口。**

滑动窗口实现面向流的可靠性

最基本的传输可靠性来源于“确认重传”机制。

**TCP的滑动窗口的可靠性也是建立在“确认重传”基础上的**。

发送窗口只有收到对端对于本段发送窗口内字节的ACK确认，才会移动发送窗口的左边界。

**接收窗口只有在前面所有的段都确认的情况下才会移动左边界**。 当在前面还有字节未接收但收到后面字节的情况下，窗口不会移动，并不对后续字节确认。以此确保对端会对这些数据重传。


###滑动窗口的流控特性

TCP的滑动窗口是动态的，我们可以想象成小学常见的一个数学题，一个水池，体积V，每小时进水量V1，出水量V2。当水池满了就不允许再注入了，如果有个液压系统控制水池大小，那么就可以控制水的注入速率和量。 这样的水池就类似TCP的窗口。应用根据自身的处理能力变化，通过本端TCP接收窗口大小控制来对对对端的发送窗口流量限制。

[来源：  https://my.oschina.net/xinxingegeya/blog/485650](https://my.oschina.net/xinxingegeya/blog/485650)